<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Word Swipe Cards</title>

<style>
:root{
  --bg:#f2f2f2;
  --card:#ffffff;
  --text:#222;
}

body.dark{
  --bg:#121212;
  --card:#1e1e1e;
  --text:#fff;
}

*{box-sizing:border-box;}

body{
  margin:0;
  background:var(--bg);
  font-family:Arial, sans-serif;
  color:var(--text);
  display:flex;
  flex-direction:column;
  align-items:center;
  height:100vh;
  overflow:hidden;
}

.top-bar{
  width:100%;
  padding:10px;
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  justify-content:center;
  background:#222;
  color:white;
}

button{
  padding:6px 12px;
  border:none;
  border-radius:20px;
  cursor:pointer;
  font-size:14px;
}

.progress{
  font-weight:bold;
  margin-right:10px;
}

.card-container{
  width:95%;
  max-width:420px;
  height:70vh;
  margin-top:15px;
  position:relative;
}

.card{
  width:100%;
  height:100%;
  border-radius:20px;
  position:absolute;
  background:var(--card);
  box-shadow:0 10px 25px rgba(0,0,0,0.3);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
  text-align:center;
  user-select:none;
  transition:transform 0.3s ease, background 0.4s ease;
}

.word{
  font-size:28px;
  font-weight:bold;
}

.details{
  display:none;
  font-size:16px;
  text-align:left;
}

.card.show .word{display:none;}
.card.show .details{display:block;}

.favorite{
  position:absolute;
  top:15px;
  right:20px;
  font-size:22px;
  cursor:pointer;
}
.favorite.active{color:red;}

@media(max-width:480px){
  .word{font-size:24px;}
}
</style>
</head>

<body>

<div class="top-bar">
  <div class="progress" id="progress">0/0</div>
  <button onclick="toggleShuffle()">Shuffle</button>
  <button onclick="toggleDark()">Dark</button>
  <button onclick="toggleFavoritesView()">Favorites</button>
  <button onclick="speakWord()">ðŸ”Š</button>
</div>

<div class="card-container">
  <div class="card" id="card">
      <div class="favorite" id="favBtn">â™¡</div>
      <div>
        <div class="word" id="word"></div>
        <div class="details" id="details"></div>
      </div>
  </div>
</div>

<script>

let words=[];
let originalWords=[];
let currentIndex=0;
let shuffleMode=false;
let showFavoritesOnly=false;
let favorites=JSON.parse(localStorage.getItem("favorites")) || [];

const card=document.getElementById("card");
const wordEl=document.getElementById("word");
const detailsEl=document.getElementById("details");
const progressEl=document.getElementById("progress");
const favBtn=document.getElementById("favBtn");

const colors=["#4CAF50","#2196F3","#FF5722","#9C27B0","#009688","#E91E63"];

function randomColor(){
  return colors[Math.floor(Math.random()*colors.length)];
}

function getActiveWords(){
  if(showFavoritesOnly){
    return words.filter(w=>favorites.includes(w.word));
  }
  return words;
}

function loadWord(){
  const activeWords=getActiveWords();
  if(activeWords.length===0){
    wordEl.textContent="No Favorites";
    detailsEl.innerHTML="";
    progressEl.textContent="0/0";
    return;
  }

  if(currentIndex>=activeWords.length) currentIndex=0;

  const data=activeWords[currentIndex];

  wordEl.textContent=data.word;
  detailsEl.innerHTML=`
    <p><b>Meaning:</b> ${data.meaning}</p>
    <p><b>Local:</b> ${data.localMeaning}</p>
    <p><b>Sentences:</b></p>
    <ul>${data.sentences.map(s=>`<li>${s}</li>`).join("")}</ul>
  `;

  card.style.background=randomColor();
  card.classList.remove("show");

  progressEl.textContent=`${currentIndex+1}/${activeWords.length}`;

  favBtn.classList.toggle("active",favorites.includes(data.word));
}

function nextWord(){
  currentIndex++;
  loadWord();
}

function prevWord(){
  currentIndex--;
  if(currentIndex<0) currentIndex=0;
  loadWord();
}

function toggleShuffle(){
  shuffleMode=!shuffleMode;
  if(shuffleMode){
    words=[...words].sort(()=>Math.random()-0.5);
  }else{
    words=[...originalWords];
  }
  currentIndex=0;
  loadWord();
}

function toggleDark(){
  document.body.classList.toggle("dark");
}

function toggleFavoritesView(){
  showFavoritesOnly=!showFavoritesOnly;
  currentIndex=0;
  loadWord();
}

function speakWord(){
  const activeWords=getActiveWords();
  if(activeWords.length===0) return;
  const utter=new SpeechSynthesisUtterance(activeWords[currentIndex].word);
  speechSynthesis.speak(utter);
}

favBtn.addEventListener("click",()=>{
  const activeWords=getActiveWords();
  if(activeWords.length===0) return;
  const word=activeWords[currentIndex].word;

  if(favorites.includes(word)){
    favorites=favorites.filter(w=>w!==word);
  }else{
    favorites.push(word);
  }

  localStorage.setItem("favorites",JSON.stringify(favorites));
  loadWord();
});

card.addEventListener("click",()=>{
  card.classList.toggle("show");
});

/* Swipe */
let startX=0;
let currentX=0;
let isDragging=false;

card.addEventListener("pointerdown",(e)=>{
  startX=e.clientX;
  isDragging=true;
});

card.addEventListener("pointermove",(e)=>{
  if(!isDragging) return;
  currentX=e.clientX-startX;
  card.style.transform=`translateX(${currentX}px) rotate(${currentX/15}deg)`;
});

card.addEventListener("pointerup",()=>{
  isDragging=false;

  if(currentX>120){
    swipeRight();
  }else if(currentX<-120){
    swipeLeft();
  }else{
    card.style.transform="";
  }
  currentX=0;
});

function swipeLeft(){
  card.style.transform="translateX(-1000px) rotate(-20deg)";
  setTimeout(()=>{
    nextWord();
    card.style.transition="none";
    card.style.transform="translateX(1000px)";
    setTimeout(()=>{
      card.style.transition="transform 0.3s ease";
      card.style.transform="";
    },50);
  },300);
}

function swipeRight(){
  card.style.transform="translateX(1000px) rotate(20deg)";
  setTimeout(()=>{
    prevWord();
    card.style.transition="none";
    card.style.transform="translateX(-1000px)";
    setTimeout(()=>{
      card.style.transition="transform 0.3s ease";
      card.style.transform="";
    },50);
  },300);
}

/* Load JSON */
fetch("words.json")
.then(res=>res.json())
.then(data=>{
  words=data;
  originalWords=[...data];
  loadWord();
});

</script>
</body>
</html>